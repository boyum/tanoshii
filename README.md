# Tanoshii (楽しい)

A Japanese vocabulary learning app with reading practice, AI-generated sentences, and conversation practice.

## Features

- **Reading Practice**: Practice reading Japanese sentences and stories generated by AI
- **Furigana & Romaji**: Toggle reading aids for kanji
- **Text-to-Speech**: Listen to native Japanese pronunciation
- **Conversation Mode**: Practice speaking Japanese with an AI conversation partner
- **JLPT N5 Level**: Content designed for beginner learners

## Requirements

- macOS (Apple Silicon M1/M2/M3/M4 recommended)
- Java 17+
- Python 3.9+
- Ollama (for AI text generation)

## Setup Instructions

### 1. Install Homebrew (if not already installed)

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

### 2. Install Java 17

```bash
brew install openjdk@17
```

Add to your shell profile (`~/.zshrc` or `~/.bash_profile`):

```bash
export JAVA_HOME=/opt/homebrew/opt/openjdk@17/libexec/openjdk.jdk/Contents/Home
export PATH="$JAVA_HOME/bin:$PATH"
```

Reload your shell:

```bash
source ~/.zshrc
```

### 3. Install Python 3

```bash
brew install python@3.11
```

### 4. Install Ollama

```bash
brew install ollama
```

Start the Ollama service:

```bash
ollama serve
```

In a new terminal, pull the Qwen model (recommended for Japanese):

```bash
ollama pull qwen2.5:7b
```

### 5. Clone and Setup the Project

```bash
git clone <repository-url>
cd jpy-wordbook
```

### 6. Setup Python Virtual Environment

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r scripts/requirements.txt
```

This installs:

- `faster-whisper` - For speech-to-text in conversation mode
- `edge-tts` - For text-to-speech audio generation

### 7. Add Vocabulary Words

Create or edit `known-words/*.csv` in the project root with your vocabulary:

```csv
japanese,romaji,english
猫,neko,cat
犬,inu,dog
学校,gakkou,school
```

Note: The "english" column is used for word hints. The AI generates English translations for sentences.

### 8. Run the Application

```bash
./gradlew run
```

The app will be available at: **http://localhost:8080**

## Usage

### Reading Practice

1. Choose a difficulty level (Easy/Medium/Hard)
2. Click "Start Session"
3. Read the Japanese text
4. Use the toggle buttons for Furigana/Romaji if needed
5. Click the speaker button to hear pronunciation
6. Click "Show Translation" to see the English meaning

### Conversation Practice

1. Click "Conversation Practice" on the home page
2. Select a scenario (restaurant, shopping, etc.)
3. Hold the microphone button and speak in Japanese
4. The AI will respond with voice

## Configuration

Edit `src/main/resources/application.yml` to customize:

```yaml
ollama:
  base-url: http://localhost:11434 # Ollama server URL
  model: qwen2.5:7b # Model to use

edge-tts:
  voice: ja-JP-NanamiNeural # Japanese voice for TTS
```

## Troubleshooting

### Ollama not responding

Make sure the Ollama service is running:

```bash
ollama serve
```

### Audio not playing

The app uses Edge TTS which requires an internet connection for the first audio generation.

### Whisper model download

On first use of conversation mode, the Whisper model will be downloaded (~500MB for "small" model). This may take a few minutes.

### Java version issues

Verify Java 17 is being used:

```bash
java -version
```

Should show version 17.x.x

## Tech Stack

- **Backend**: Kotlin + Micronaut
- **Frontend**: Thymeleaf + HTMX
- **AI**: Ollama (Qwen 2.5)
- **TTS**: Edge TTS (Microsoft)
- **STT**: Faster Whisper
- **Japanese Processing**: Kuromoji (furigana/romaji)
- **Database**: SQLite

## License

MIT
